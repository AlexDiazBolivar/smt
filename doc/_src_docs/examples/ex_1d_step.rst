1-D step-like data set (RMTS)
=============================

RMTB
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTB
  
  xt = np.array([
      0.0000,    0.4000,    0.6000,    0.7000,    0.7500,
      0.7750,    0.8000,    0.8500,    0.8750,    0.9000,
      0.9250,    0.9500,    0.9750,    1.0000,    1.0250,
      1.0500,    1.1000,    1.2000,    1.3000,    1.4000,
      1.6000,    1.8000,    2.0000,
  ], dtype=np.float64)
  yt = np.array([
      0.0130,     0.0130,     0.0130,     0.0130,   0.0130,
      0.0130,     0.0130,     0.0132,     0.0135,   0.0140,
      0.0162,     0.0230,     0.0275,     0.0310,   0.0344,
      0.0366,     0.0396,     0.0410,     0.0403,   0.0390,
      0.0360,     0.0350,     0.0345,
  ], dtype=np.float64)
  
  xlimits = np.array([[0.0, 2.0]])
  
  interp = RMTB(num_ctrl_pts=100, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTB
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0000041
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0007939
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0023930
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0005510
        Pre-computing matrices - done. Time (sec):  0.0038307
        Solving for degrees of freedom ...
           Solving initial linear problem (n=100) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0008969
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000789
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (100 x 100 mtx) ...
                 Running cg Krylov solver (100 x 100 mtx) - done. Time (sec):  0.0068750
              Solving linear system (col. 0) - done. Time (sec):  0.0069230
           Solving initial linear problem (n=100) - done. Time (sec):  0.0079758
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 1.552186811e-11 2.217740009e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0013981
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000372
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0061321
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0002370
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 1.404041039e-11 2.190118366e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008163
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000260
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048711
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000410
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 4.546609896e-10 1.386359367e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007701
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000210
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052302
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000448
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 3.061396389e-10 8.862628830e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008471
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000222
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052388
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 8.996405942e-11 2.349517856e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007679
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000191
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048549
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000412
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 2.599226877e-11 1.114104776e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007639
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000191
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0061131
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000770
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 8.122882728e-12 9.097495833e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0013690
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000219
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0053818
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000761
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 7.536042956e-12 9.064665549e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008190
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000179
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051730
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000460
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 2.061562843e-12 8.549347848e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007761
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000210
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050709
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000429
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 5.697949874e-13 8.474106456e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007720
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000200
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051291
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000463
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 1.822891031e-13 8.460318161e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007920
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000231
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049050
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000408
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 5.079064365e-14 8.454141952e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007610
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000191
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0056119
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000770
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 1.436505672e-14 8.453442685e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0014331
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000219
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0054319
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000460
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 4.930948651e-15 8.453304906e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008414
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000210
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050461
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000699
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 3.105126397e-15 8.453286412e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007610
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000179
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051219
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000432
              Nonlinear (itn, iy, grad. norm, func.) :  15   0 2.091950846e-15 8.453285440e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007873
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000231
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048399
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000398
              Nonlinear (itn, iy, grad. norm, func.) :  16   0 1.629696614e-15 8.453276777e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007589
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000188
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050290
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000792
              Nonlinear (itn, iy, grad. norm, func.) :  17   0 3.581438694e-16 8.453270889e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0014391
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000358
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0058391
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001080
              Nonlinear (itn, iy, grad. norm, func.) :  18   0 2.792878910e-16 8.453270841e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008562
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000231
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002258
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0004961
              Nonlinear (itn, iy, grad. norm, func.) :  19   0 2.792836490e-16 8.453270841e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008063
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000200
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0001931
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0008540
              Nonlinear (itn, iy, grad. norm, func.) :  20   0 2.792836485e-16 8.453270841e-15
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.1272750
        Solving for degrees of freedom - done. Time (sec):  0.1353252
     Training - done. Time (sec):  0.1400409
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0004690
     
     Prediction time/pt. (sec) :  0.0000009
     
  
.. figure:: ex_1d_step.png
  :scale: 80 %
  :align: center

RMTC
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTC
  
  xt = np.array([
      0.0000,    0.4000,    0.6000,    0.7000,    0.7500,
      0.7750,    0.8000,    0.8500,    0.8750,    0.9000,
      0.9250,    0.9500,    0.9750,    1.0000,    1.0250,
      1.0500,    1.1000,    1.2000,    1.3000,    1.4000,
      1.6000,    1.8000,    2.0000,
  ], dtype=np.float64)
  yt = np.array([
      0.0130,     0.0130,     0.0130,     0.0130,   0.0130,
      0.0130,     0.0130,     0.0132,     0.0135,   0.0140,
      0.0162,     0.0230,     0.0275,     0.0310,   0.0344,
      0.0366,     0.0396,     0.0410,     0.0403,   0.0390,
      0.0360,     0.0350,     0.0345,
  ], dtype=np.float64)
  
  xlimits = np.array([[0.0, 2.0]])
  
  interp = RMTC(num_elements=40, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTC
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0008771
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0002840
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0012178
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0005610
        Pre-computing matrices - done. Time (sec):  0.0030131
        Solving for degrees of freedom ...
           Solving initial linear problem (n=82) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0004940
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000210
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (82 x 82 mtx) ...
                 Running cg Krylov solver (82 x 82 mtx) - done. Time (sec):  0.0049710
              Solving linear system (col. 0) - done. Time (sec):  0.0049930
           Solving initial linear problem (n=82) - done. Time (sec):  0.0055511
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 7.483532044e-12 2.493150298e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0011151
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000291
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0071659
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0002477
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 9.032495044e-12 2.482796195e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008252
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000269
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050609
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001009
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 8.671236796e-11 2.387442557e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007939
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000231
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0064399
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000799
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 9.651613003e-11 2.269711639e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008731
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000272
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050790
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000420
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 2.832795000e-11 1.317843273e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007610
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000200
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048070
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000701
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 1.513844619e-11 1.197072509e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0015402
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000381
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0064530
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000470
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 4.305373634e-12 1.123414104e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008328
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000188
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051379
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000429
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 1.267945843e-12 1.111748928e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007527
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000179
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0058498
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000777
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 4.481785520e-13 1.109776660e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009060
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000193
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052590
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000429
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 1.315099112e-13 1.109095003e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007689
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000188
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048401
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000403
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 3.762250507e-14 1.108966145e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007601
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000169
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050187
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 9.912737630e-15 1.108943593e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007780
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000222
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048449
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000398
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 2.005184866e-15 1.108940543e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007670
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000179
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0056610
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 1.932624149e-16 1.108940342e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008171
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000231
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049121
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000420
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 6.579070269e-18 1.108940339e-14
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.0970209
        Solving for degrees of freedom - done. Time (sec):  0.1026328
     Training - done. Time (sec):  0.1063371
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0004530
     
     Prediction time/pt. (sec) :  0.0000009
     
  
.. figure:: ex_1d_step.png
  :scale: 80 %
  :align: center
