1-D step-like data set (RMTS)
=============================

RMTB
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTB
  
  xt = np.array([
      0.0000,    0.4000,    0.6000,    0.7000,    0.7500,
      0.7750,    0.8000,    0.8500,    0.8750,    0.9000,
      0.9250,    0.9500,    0.9750,    1.0000,    1.0250,
      1.0500,    1.1000,    1.2000,    1.3000,    1.4000,
      1.6000,    1.8000,    2.0000,
  ], dtype=np.float64)
  yt = np.array([
      0.0130,     0.0130,     0.0130,     0.0130,   0.0130,
      0.0130,     0.0130,     0.0132,     0.0135,   0.0140,
      0.0162,     0.0230,     0.0275,     0.0310,   0.0344,
      0.0366,     0.0396,     0.0410,     0.0403,   0.0390,
      0.0360,     0.0350,     0.0345,
  ], dtype=np.float64)
  
  xlimits = np.array([[0.0, 2.0]])
  
  interp = RMTB(num_ctrl_pts=100, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTB
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0000000
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0000000
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0000000
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0000000
        Pre-computing matrices - done. Time (sec):  0.0000000
        Solving for degrees of freedom ...
           Solving initial linear problem (n=100) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0000000
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000000
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (100 x 100 mtx) ...
                 Running cg Krylov solver (100 x 100 mtx) - done. Time (sec):  0.0000000
              Solving linear system (col. 0) - done. Time (sec):  0.0000000
           Solving initial linear problem (n=100) - done. Time (sec):  0.0000000
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 1.429171672e-11 2.245885061e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0160000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 1.264736139e-11 2.218236057e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 4.449182905e-10 1.350718566e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 3.130286166e-10 9.022938954e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 9.209118974e-11 2.377360269e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 2.662784332e-11 1.117760192e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0149999
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 1.941781515e-11 1.047191523e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 5.352960501e-12 8.798638426e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 3.734212897e-12 8.681847610e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0160000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 9.643332647e-13 8.486244014e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 2.688648230e-13 8.461017244e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0150001
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 2.313429055e-13 8.460043769e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 6.719954905e-14 8.454595304e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 1.917507119e-14 8.453479181e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0159998
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 4.787446674e-15 8.453301287e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  15   0 2.245941835e-15 8.453282549e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  16   0 6.137488449e-16 8.453272965e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0160000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  17   0 1.004116599e-15 8.453272236e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  18   0 1.922269782e-16 8.453270737e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0150001
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  19   0 1.859369000e-16 8.453270570e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  20   0 2.355516985e-16 8.453270566e-15
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.1250000
        Solving for degrees of freedom - done. Time (sec):  0.1250000
     Training - done. Time (sec):  0.1250000
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0000000
     
     Prediction time/pt. (sec) :  0.0000000
     
  
.. figure:: ex_1d_step.png
  :scale: 80 %
  :align: center

RMTC
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTC
  
  xt = np.array([
      0.0000,    0.4000,    0.6000,    0.7000,    0.7500,
      0.7750,    0.8000,    0.8500,    0.8750,    0.9000,
      0.9250,    0.9500,    0.9750,    1.0000,    1.0250,
      1.0500,    1.1000,    1.2000,    1.3000,    1.4000,
      1.6000,    1.8000,    2.0000,
  ], dtype=np.float64)
  yt = np.array([
      0.0130,     0.0130,     0.0130,     0.0130,   0.0130,
      0.0130,     0.0130,     0.0132,     0.0135,   0.0140,
      0.0162,     0.0230,     0.0275,     0.0310,   0.0344,
      0.0366,     0.0396,     0.0410,     0.0403,   0.0390,
      0.0360,     0.0350,     0.0345,
  ], dtype=np.float64)
  
  xlimits = np.array([[0.0, 2.0]])
  
  interp = RMTC(num_elements=40, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTC
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0149999
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0000000
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0000000
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0000000
        Pre-computing matrices - done. Time (sec):  0.0149999
        Solving for degrees of freedom ...
           Solving initial linear problem (n=82) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0000000
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000000
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (82 x 82 mtx) ...
                 Running cg Krylov solver (82 x 82 mtx) - done. Time (sec):  0.0000000
              Solving linear system (col. 0) - done. Time (sec):  0.0000000
           Solving initial linear problem (n=82) - done. Time (sec):  0.0000000
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 7.484146496e-12 2.493686335e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 9.032461667e-12 2.483319875e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0160000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 8.731317212e-11 2.394374631e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 4.200952964e-11 1.678696726e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0160000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 3.345905442e-11 1.517829415e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 1.885477430e-11 1.285255378e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 2.304942826e-11 1.241764968e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0150001
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 6.468549868e-12 1.130640521e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 3.882991422e-12 1.120919125e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 2.342061369e-12 1.115440342e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0160000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 6.156838794e-13 1.110032135e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 1.257757676e-13 1.109079175e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0149999
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 2.948218174e-14 1.108959234e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 6.951105297e-15 1.108942389e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 1.300396543e-15 1.108940471e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0160000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  15   0 1.378083560e-16 1.108940346e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  16   0 1.728512169e-16 1.108940343e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0000000
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000000
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0000000
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000000
              Nonlinear (itn, iy, grad. norm, func.) :  17   0 1.129183916e-17 1.108940339e-14
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.0940001
        Solving for degrees of freedom - done. Time (sec):  0.0940001
     Training - done. Time (sec):  0.1090000
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0000000
     
     Prediction time/pt. (sec) :  0.0000000
     
  
.. figure:: ex_1d_step.png
  :scale: 80 %
  :align: center
