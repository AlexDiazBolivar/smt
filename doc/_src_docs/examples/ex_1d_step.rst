1-D step-like data set
======================

.. code-block:: python

  import numpy as np
  
  
  def get_one_d_step():
      xt = np.array([
          0.0000,    0.4000,    0.6000,    0.7000,    0.7500,
          0.7750,    0.8000,    0.8500,    0.8750,    0.9000,
          0.9250,    0.9500,    0.9750,    1.0000,    1.0250,
          1.0500,    1.1000,    1.2000,    1.3000,    1.4000,
          1.6000,    1.8000,    2.0000,
      ], dtype=np.float64)
      yt = np.array([
          0.0130,     0.0130,     0.0130,     0.0130,   0.0130,
          0.0130,     0.0130,     0.0132,     0.0135,   0.0140,
          0.0162,     0.0230,     0.0275,     0.0310,   0.0344,
          0.0366,     0.0396,     0.0410,     0.0403,   0.0390,
          0.0360,     0.0350,     0.0345,
      ], dtype=np.float64)
  
      xlimits = np.array([[0.0, 2.0]])
  
      return xt, yt, xlimits
  

RMTB
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTB
  from smt.examples.one_d_step import get_one_d_step
  
  xt, yt, xlimits = get_one_d_step()
  
  interp = RMTB(num_ctrl_pts=100, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.xlabel('x')
  plt.ylabel('y')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTB
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0000079
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0006058
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0014920
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0004458
        Pre-computing matrices - done. Time (sec):  0.0026500
        Solving for degrees of freedom ...
           Solving initial linear problem (n=100) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0005000
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000291
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (100 x 100 mtx) ...
                 Running cg Krylov solver (100 x 100 mtx) - done. Time (sec):  0.0085819
              Solving linear system (col. 0) - done. Time (sec):  0.0086219
           Solving initial linear problem (n=100) - done. Time (sec):  0.0091882
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 1.552186811e-11 2.217740009e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009747
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000420
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0093219
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0002618
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 1.404041039e-11 2.190118366e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009100
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000298
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050843
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000510
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 4.546609896e-10 1.386359367e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008190
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000260
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049899
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 3.061396389e-10 8.862628830e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007942
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000231
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0053918
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000451
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 8.995170367e-11 2.349653461e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009220
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000529
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0061271
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000448
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 2.597427578e-11 1.114352854e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007942
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000250
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050092
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000510
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 7.125308177e-12 8.921690794e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0018339
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000420
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0059090
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000770
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 2.128902679e-12 8.551710539e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009670
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000281
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050790
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000420
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 4.588890135e-13 8.464352917e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007949
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000231
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0054851
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000429
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 1.280998567e-13 8.455983004e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008099
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000250
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050292
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000463
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 3.726279602e-14 8.454708365e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0019069
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000422
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0073688
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0003152
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 4.387134805e-14 8.454097781e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0010927
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000303
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050111
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000420
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 1.196659242e-14 8.453352312e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008030
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000250
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0058370
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000458
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 3.126695077e-15 8.453295392e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008252
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000329
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052731
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001280
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 2.794792040e-15 8.453294431e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007963
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000248
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049999
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001161
              Nonlinear (itn, iy, grad. norm, func.) :  15   0 2.174484724e-15 8.453292050e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008681
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000291
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0054691
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000489
              Nonlinear (itn, iy, grad. norm, func.) :  16   0 8.713003946e-16 8.453276475e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008199
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000241
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050187
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000432
              Nonlinear (itn, iy, grad. norm, func.) :  17   0 1.831098632e-16 8.453270693e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0011351
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000269
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002179
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0007639
              Nonlinear (itn, iy, grad. norm, func.) :  18   0 1.831098973e-16 8.453270693e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009401
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000272
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002201
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0011587
              Nonlinear (itn, iy, grad. norm, func.) :  19   0 1.831098973e-16 8.453270693e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007999
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000250
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002081
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0010941
              Nonlinear (itn, iy, grad. norm, func.) :  20   0 1.831098973e-16 8.453270693e-15
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.1341112
        Solving for degrees of freedom - done. Time (sec):  0.1434071
     Training - done. Time (sec):  0.1468799
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0004752
     
     Prediction time/pt. (sec) :  0.0000010
     
  
.. figure:: ex_1d_step_Test_test_rmtb.png
  :scale: 80 %
  :align: center

RMTC
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTC
  from smt.examples.one_d_step import get_one_d_step
  
  xt, yt, xlimits = get_one_d_step()
  
  interp = RMTC(num_elements=40, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.xlabel('x')
  plt.ylabel('y')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTC
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0008488
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0002723
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0011849
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0005469
        Pre-computing matrices - done. Time (sec):  0.0029330
        Solving for degrees of freedom ...
           Solving initial linear problem (n=82) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0004697
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000210
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (82 x 82 mtx) ...
                 Running cg Krylov solver (82 x 82 mtx) - done. Time (sec):  0.0054309
              Solving linear system (col. 0) - done. Time (sec):  0.0054681
           Solving initial linear problem (n=82) - done. Time (sec):  0.0059900
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 7.483532044e-12 2.493150298e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008321
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000262
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0055399
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0002449
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 9.032493674e-12 2.482796179e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0010443
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000319
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050199
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001023
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 8.663377252e-11 2.386573982e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007989
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000257
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0054867
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 4.252844494e-11 1.662502870e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008030
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000241
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0068259
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001028
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 3.486705680e-11 1.525820491e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008051
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000241
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0054772
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000732
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 1.969024506e-11 1.291057889e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008032
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000250
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051880
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 2.377647732e-11 1.247954388e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007958
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000241
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0071480
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000858
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 6.680397619e-12 1.131784565e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0015028
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000441
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0065427
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000451
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 1.844778745e-12 1.112539886e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008111
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000272
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049610
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000720
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 1.076738796e-12 1.110864740e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008109
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000281
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0056398
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000432
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 4.485078505e-13 1.109692750e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008109
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000279
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052984
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 1.201187979e-13 1.109066517e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0012150
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000310
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051410
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000451
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 3.411860174e-14 1.108960889e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008230
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000288
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0053360
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000489
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 9.056867693e-15 1.108942980e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008161
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000281
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0053489
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000470
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 1.881930644e-15 1.108940541e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008328
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000300
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052099
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000429
              Nonlinear (itn, iy, grad. norm, func.) :  15   0 1.875222521e-16 1.108940344e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007942
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000260
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050750
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000432
              Nonlinear (itn, iy, grad. norm, func.) :  16   0 1.646430548e-17 1.108940340e-14
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.1144550
        Solving for degrees of freedom - done. Time (sec):  0.1205211
     Training - done. Time (sec):  0.1238241
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0004632
     
     Prediction time/pt. (sec) :  0.0000009
     
  
.. figure:: ex_1d_step_Test_test_rmtc.png
  :scale: 80 %
  :align: center
