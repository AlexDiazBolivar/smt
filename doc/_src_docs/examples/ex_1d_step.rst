1-D step-like data set (RMTS)
=============================

RMTB
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTB
  
  xt = np.array([
      0.0000,    0.4000,    0.6000,    0.7000,    0.7500,
      0.7750,    0.8000,    0.8500,    0.8750,    0.9000,
      0.9250,    0.9500,    0.9750,    1.0000,    1.0250,
      1.0500,    1.1000,    1.2000,    1.3000,    1.4000,
      1.6000,    1.8000,    2.0000,
  ], dtype=np.float64)
  yt = np.array([
      0.0130,     0.0130,     0.0130,     0.0130,   0.0130,
      0.0130,     0.0130,     0.0132,     0.0135,   0.0140,
      0.0162,     0.0230,     0.0275,     0.0310,   0.0344,
      0.0366,     0.0396,     0.0410,     0.0403,   0.0390,
      0.0360,     0.0350,     0.0345,
  ], dtype=np.float64)
  
  xlimits = np.array([[0.0, 2.0]])
  
  interp = RMTB(num_ctrl_pts=100, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTB
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0000038
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0003839
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0030212
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0008929
        Pre-computing matrices - done. Time (sec):  0.0044200
        Solving for degrees of freedom ...
           Solving initial linear problem (n=100) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0016069
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000441
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (100 x 100 mtx) ...
                 Running cg Krylov solver (100 x 100 mtx) - done. Time (sec):  0.0072279
              Solving linear system (col. 0) - done. Time (sec):  0.0072711
           Solving initial linear problem (n=100) - done. Time (sec):  0.0089881
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 1.552186811e-11 2.217740009e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008779
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000248
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0058570
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0002360
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 1.401101034e-11 2.190102642e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008361
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000279
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0053782
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000451
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 4.589467596e-10 1.409574874e-13
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008211
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000279
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0057778
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000460
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 3.276761695e-10 9.579152155e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008209
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000300
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049982
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000439
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 9.640322928e-11 2.486735087e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0010343
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000572
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051363
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0002789
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 9.123620867e-11 2.432120088e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0012488
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000379
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0058382
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000498
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 2.653779902e-11 1.138423730e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008271
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000288
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0072052
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001187
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 7.307116476e-12 8.931233600e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0013442
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000501
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0092731
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000441
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 1.741007791e-12 8.504915612e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008070
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000262
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0053151
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000441
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 2.813281077e-13 8.457333714e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0011961
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000379
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0071828
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000818
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 1.541199355e-13 8.455331032e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008099
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000279
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052989
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000520
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 2.424357583e-14 8.453550691e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008461
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000300
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051100
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000541
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 8.616405701e-15 8.453362132e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008657
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000310
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0052500
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000899
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 2.089925673e-15 8.453290099e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0015759
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000548
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0095072
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001333
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 9.091489541e-16 8.453276225e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0012240
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000288
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0100498
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000970
              Nonlinear (itn, iy, grad. norm, func.) :  15   0 3.242340084e-16 8.453271081e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0038910
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000319
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002360
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000708
              Nonlinear (itn, iy, grad. norm, func.) :  16   0 5.372435493e-16 8.453270901e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008020
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000248
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0076637
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001509
              Nonlinear (itn, iy, grad. norm, func.) :  17   0 4.102724336e-16 8.453270863e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0011148
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000291
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002110
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0007038
              Nonlinear (itn, iy, grad. norm, func.) :  18   0 4.102724377e-16 8.453270863e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008001
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000257
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002081
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0008841
              Nonlinear (itn, iy, grad. norm, func.) :  19   0 4.102724377e-16 8.453270863e-15
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0016229
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000291
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0002191
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0010889
              Nonlinear (itn, iy, grad. norm, func.) :  20   0 4.102724377e-16 8.453270863e-15
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.1483159
        Solving for degrees of freedom - done. Time (sec):  0.1574061
     Training - done. Time (sec):  0.1622500
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0007381
     
     Prediction time/pt. (sec) :  0.0000015
     
  
.. figure:: ex_1d_step.png
  :scale: 80 %
  :align: center

RMTC
----

.. code-block:: python

  import numpy as np
  import matplotlib.pyplot as plt
  
  from smt.methods import RMTC
  
  xt = np.array([
      0.0000,    0.4000,    0.6000,    0.7000,    0.7500,
      0.7750,    0.8000,    0.8500,    0.8750,    0.9000,
      0.9250,    0.9500,    0.9750,    1.0000,    1.0250,
      1.0500,    1.1000,    1.2000,    1.3000,    1.4000,
      1.6000,    1.8000,    2.0000,
  ], dtype=np.float64)
  yt = np.array([
      0.0130,     0.0130,     0.0130,     0.0130,   0.0130,
      0.0130,     0.0130,     0.0132,     0.0135,   0.0140,
      0.0162,     0.0230,     0.0275,     0.0310,   0.0344,
      0.0366,     0.0396,     0.0410,     0.0403,   0.0390,
      0.0360,     0.0350,     0.0345,
  ], dtype=np.float64)
  
  xlimits = np.array([[0.0, 2.0]])
  
  interp = RMTC(num_elements=40, xlimits=xlimits, nln_max_iter=20, reg_cons=1e-14)
  
  interp.set_training_values(xt, yt)
  interp.train()
  
  num = 500
  
  x = np.linspace(0., 2., num)
  y = interp.predict_values(x)[:, 0]
  
  plt.plot(x, y)
  plt.plot(xt, yt, 'o')
  plt.show()
  
::

  ___________________________________________________________________________
     
                                     RMTC
  ___________________________________________________________________________
     
   Problem size
     
        # training points.        : 23
     
  ___________________________________________________________________________
     
   Training
     
     Training ...
        Pre-computing matrices ...
           Computing dof2coeff ...
           Computing dof2coeff - done. Time (sec):  0.0008147
           Initializing Hessian ...
           Initializing Hessian - done. Time (sec):  0.0002611
           Computing energy terms ...
           Computing energy terms - done. Time (sec):  0.0011470
           Computing approximation terms ...
           Computing approximation terms - done. Time (sec):  0.0012450
        Pre-computing matrices - done. Time (sec):  0.0035560
        Solving for degrees of freedom ...
           Solving initial linear problem (n=82) ...
              Assembling linear system ...
              Assembling linear system - done. Time (sec):  0.0004730
              Initializing linear solver ...
              Initializing linear solver - done. Time (sec):  0.0000219
              Solving linear system (col. 0) ...
                 Running cg Krylov solver (82 x 82 mtx) ...
                 Running cg Krylov solver (82 x 82 mtx) - done. Time (sec):  0.0052621
              Solving linear system (col. 0) - done. Time (sec):  0.0053058
           Solving initial linear problem (n=82) - done. Time (sec):  0.0058367
           Solving nonlinear problem (col. 0) ...
              Nonlinear (itn, iy, grad. norm, func.) :   0   0 7.483532044e-12 2.493150298e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009170
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000238
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0054710
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0002301
              Nonlinear (itn, iy, grad. norm, func.) :   1   0 9.032493674e-12 2.482796179e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0012779
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000291
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048618
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000989
              Nonlinear (itn, iy, grad. norm, func.) :   2   0 8.663377252e-11 2.386573982e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008149
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000269
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049040
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000510
              Nonlinear (itn, iy, grad. norm, func.) :   3   0 4.252844494e-11 1.662502870e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008190
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000281
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0050850
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000989
              Nonlinear (itn, iy, grad. norm, func.) :   4   0 3.464487600e-11 1.522115267e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007973
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000281
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049889
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001469
              Nonlinear (itn, iy, grad. norm, func.) :   5   0 1.955136968e-11 1.289122560e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008147
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000279
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048802
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000889
              Nonlinear (itn, iy, grad. norm, func.) :   6   0 2.380241313e-11 1.247855286e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008020
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000260
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0048580
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000420
              Nonlinear (itn, iy, grad. norm, func.) :   7   0 6.688277509e-12 1.131766001e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0007899
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000229
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0057030
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000939
              Nonlinear (itn, iy, grad. norm, func.) :   8   0 1.912075150e-12 1.113090674e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0029850
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000570
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0083759
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000908
              Nonlinear (itn, iy, grad. norm, func.) :   9   0 1.123467530e-12 1.111183463e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008602
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000300
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0058360
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001628
              Nonlinear (itn, iy, grad. norm, func.) :  10   0 2.895506061e-13 1.109374207e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0016210
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000319
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0051987
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000460
              Nonlinear (itn, iy, grad. norm, func.) :  11   0 6.467701324e-14 1.109004050e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008278
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000269
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0061200
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0001400
              Nonlinear (itn, iy, grad. norm, func.) :  12   0 1.707388230e-14 1.108949315e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008321
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000298
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049894
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000603
              Nonlinear (itn, iy, grad. norm, func.) :  13   0 3.991309663e-15 1.108941249e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0009470
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000329
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0049820
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000541
              Nonlinear (itn, iy, grad. norm, func.) :  14   0 6.050553871e-16 1.108940409e-14
                 Assembling linear system ...
                 Assembling linear system - done. Time (sec):  0.0008249
                 Initializing linear solver ...
                 Initializing linear solver - done. Time (sec):  0.0000269
                 Solving linear system ...
                 Solving linear system - done. Time (sec):  0.0059960
                 Performing line search ...
                 Performing line search - done. Time (sec):  0.0000782
              Nonlinear (itn, iy, grad. norm, func.) :  15   0 6.271859619e-17 1.108940342e-14
           Solving nonlinear problem (col. 0) - done. Time (sec):  0.1106188
        Solving for degrees of freedom - done. Time (sec):  0.1165493
     Training - done. Time (sec):  0.1205201
  ___________________________________________________________________________
     
   Evaluation
     
        # eval points. : 500
     
     Predicting ...
     Predicting - done. Time (sec):  0.0004950
     
     Prediction time/pt. (sec) :  0.0000010
     
  
.. figure:: ex_1d_step.png
  :scale: 80 %
  :align: center
