

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>smt.methods.sm &#8212; SMT 0.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SMT 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for smt.methods.sm</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Author: Dr. Mohamed Amine Bouhlel &lt;mbouhlel@umich.edu&gt;</span>
<span class="sd">        Dr. John T. Hwang         &lt;hwangjt@umich.edu&gt;</span>

<span class="sd">Metamodels - a base class for metamodel methods</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#TODO: Extend to multifidelity problems by adding training_points = {&#39;approx&#39;: {}}</span>
<span class="c1">#TODO: Complete the mixture of expert model: verify from if self.options[&#39;name&#39;] == &#39;MixExp&#39;: (predict)</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>

<span class="kn">from</span> <span class="nn">smt.utils.printer</span> <span class="k">import</span> <span class="n">Printer</span>
<span class="kn">from</span> <span class="nn">smt.utils.options_dictionary</span> <span class="k">import</span> <span class="n">OptionsDictionary</span>
<span class="kn">from</span> <span class="nn">smt.utils.checks</span> <span class="k">import</span> <span class="n">check_support</span><span class="p">,</span> <span class="n">check_nx</span><span class="p">,</span> <span class="n">check_2d_array</span>


<div class="viewcode-block" id="SM"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM">[docs]</a><span class="k">class</span> <span class="nc">SM</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for all surrogate models.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    options : OptionsDictionary</span>
<span class="sd">        Dictionary of options. Options values can be set on this attribute directly</span>
<span class="sd">        or they can be passed in as keyword arguments during instantiation.</span>
<span class="sd">    supports : dict</span>
<span class="sd">        Dictionary containing information about what this surrogate model supports.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from smt.methods import RBF</span>
<span class="sd">    &gt;&gt;&gt; sm = RBF(print_training=False)</span>
<span class="sd">    &gt;&gt;&gt; sm.options[&#39;print_prediction&#39;] = False</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SM.__init__"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor where values of options can be passed in.</span>

<span class="sd">        For the list of options, see the documentation for the surrogate model being used.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : named arguments</span>
<span class="sd">            Set of options that can be optionally set; each option must have been declared.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from smt.methods import RBF</span>
<span class="sd">        &gt;&gt;&gt; sm = RBF(print_global=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">OptionsDictionary</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">supports</span> <span class="o">=</span> <span class="n">supports</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;training_derivatives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;derivatives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;output_derivatives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;adjoint_api&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;variances&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">declare</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">declare</span>

        <span class="n">declare</span><span class="p">(</span><span class="s1">&#39;print_global&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Global print toggle. If False, all printing is suppressed&#39;</span><span class="p">)</span>
        <span class="n">declare</span><span class="p">(</span><span class="s1">&#39;print_training&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Whether to print training information&#39;</span><span class="p">)</span>
        <span class="n">declare</span><span class="p">(</span><span class="s1">&#39;print_prediction&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Whether to print prediction information&#39;</span><span class="p">)</span>
        <span class="n">declare</span><span class="p">(</span><span class="s1">&#39;print_problem&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Whether to print problem information&#39;</span><span class="p">)</span>
        <span class="n">declare</span><span class="p">(</span><span class="s1">&#39;print_solver&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Whether to print solver information&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span> <span class="o">=</span> <span class="n">Printer</span><span class="p">()</span></div>

<div class="viewcode-block" id="SM.set_training_values"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.set_training_values">[docs]</a>    <span class="k">def</span> <span class="nf">set_training_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xt</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set training data (values).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xt : np.ndarray[nt, nx] or np.ndarray[nt]</span>
<span class="sd">            The input values for the nt training points.</span>
<span class="sd">        yt : np.ndarray[nt, ny] or np.ndarray[nt]</span>
<span class="sd">            The output values for the nt training points.</span>
<span class="sd">        name : str or None</span>
<span class="sd">            An optional label for the group of training points being set.</span>
<span class="sd">            This is only used in special situations (e.g., multi-fidelity applications).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xt</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="s1">&#39;xt&#39;</span><span class="p">)</span>
        <span class="n">yt</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;yt&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">yt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;the first dimension of xt and yt must have the same length&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="n">xt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">xt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">kx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">xt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">kx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xt</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yt</span><span class="p">)]</span></div>

    <span class="k">def</span> <span class="nf">update_training_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the training data (values) at the previously set input values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        yt : np.ndarray[nt, ny] or np.ndarray[nt]</span>
<span class="sd">            The output values for the nt training points.</span>
<span class="sd">        name : str or None</span>
<span class="sd">            An optional label for the group of training points being set.</span>
<span class="sd">            This is only used in special situations (e.g., multi-fidelity applications).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yt</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;yt&#39;</span><span class="p">)</span>

        <span class="n">kx</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">kx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;The training points must be set first with set_training_values &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;before calling update_training_values.&#39;</span><span class="p">)</span>

        <span class="n">xt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">kx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">xt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">yt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;The number of training points does not agree with the earlier call of &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;set_training_values.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">kx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yt</span><span class="p">)</span>

<div class="viewcode-block" id="SM.set_training_derivatives"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.set_training_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">set_training_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xt</span><span class="p">,</span> <span class="n">dyt_dxt</span><span class="p">,</span> <span class="n">kx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set training data (derivatives).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xt : np.ndarray[nt, nx] or np.ndarray[nt]</span>
<span class="sd">            The input values for the nt training points.</span>
<span class="sd">        dyt_dxt : np.ndarray[nt, ny] or np.ndarray[nt]</span>
<span class="sd">            The derivatives values for the nt training points.</span>
<span class="sd">        kx : int</span>
<span class="sd">            0-based index of the derivatives being set.</span>
<span class="sd">        name : str or None</span>
<span class="sd">            An optional label for the group of training points being set.</span>
<span class="sd">            This is only used in special situations (e.g., multi-fidelity applications).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;training_derivatives&#39;</span><span class="p">)</span>

        <span class="n">xt</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="s1">&#39;xt&#39;</span><span class="p">)</span>
        <span class="n">dyt_dxt</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">dyt_dxt</span><span class="p">,</span> <span class="s1">&#39;dyt_dxt&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dyt_dxt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;the first dimension of xt and dyt_dxt must have the same length&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kx</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;kx must be an int&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">kx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xt</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dyt_dxt</span><span class="p">)]</span></div>

    <span class="k">def</span> <span class="nf">update_training_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dyt_dxt</span><span class="p">,</span> <span class="n">kx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the training data (values) at the previously set input values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dyt_dxt : np.ndarray[nt, ny] or np.ndarray[nt]</span>
<span class="sd">            The derivatives values for the nt training points.</span>
<span class="sd">        kx : int</span>
<span class="sd">            0-based index of the derivatives being set.</span>
<span class="sd">        name : str or None</span>
<span class="sd">            An optional label for the group of training points being set.</span>
<span class="sd">            This is only used in special situations (e.g., multi-fidelity applications).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;training_derivatives&#39;</span><span class="p">)</span>

        <span class="n">dyt_dxt</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">dyt_dxt</span><span class="p">,</span> <span class="s1">&#39;dyt_dxt&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;The training points must be set first with set_training_values &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;before calling update_training_values.&#39;</span><span class="p">)</span>

        <span class="n">xt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">kx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">xt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dyt_dxt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;The number of training points does not agree with the earlier call of &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;set_training_values.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">kx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dyt_dxt</span><span class="p">)</span>

<div class="viewcode-block" id="SM.train"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.train">[docs]</a>    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Train the model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_exact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_points</span><span class="p">[</span><span class="kc">None</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_global&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_line_break</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_center</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_global&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_problem&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_title</span><span class="p">(</span><span class="s1">&#39;Problem size&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">(</span><span class="s1">&#39;   </span><span class="si">%-25s</span><span class="s1"> : </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;# training points.&#39;</span><span class="p">,</span> <span class="n">n_exact</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_global&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_training&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MixExp&#39;</span><span class="p">:</span>
            <span class="c1"># Mixture of experts model</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_title</span><span class="p">(</span><span class="s1">&#39;Training of the Mixture of experts&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_title</span><span class="p">(</span><span class="s1">&#39;Training&#39;</span><span class="p">)</span>

        <span class="c1">#Train the model using the specified model-method</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_timed_context</span><span class="p">(</span><span class="s1">&#39;Training&#39;</span><span class="p">,</span> <span class="s1">&#39;training&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_train</span><span class="p">()</span></div>

<div class="viewcode-block" id="SM.predict_values"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.predict_values">[docs]</a>    <span class="k">def</span> <span class="nf">predict_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict the output values at a set of points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx] or np.ndarray[n]</span>
<span class="sd">            Input values for the prediction points.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        y : np.ndarray[n, ny]</span>
<span class="sd">            Output values at the prediction points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">check_nx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_global&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_prediction&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MixExp&#39;</span><span class="p">:</span>
            <span class="c1"># Mixture of experts model</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_title</span><span class="p">(</span><span class="s1">&#39;Evaluation of the Mixture of experts&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_title</span><span class="p">(</span><span class="s1">&#39;Evaluation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">(</span><span class="s1">&#39;   </span><span class="si">%-12s</span><span class="s1"> : </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;# eval points.&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">()</span>

        <span class="c1">#Evaluate the unknown points using the specified model-method</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_timed_context</span><span class="p">(</span><span class="s1">&#39;Predicting&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;prediction&#39;</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">time_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_time</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Prediction time/pt. (sec) : </span><span class="si">%10.7f</span><span class="s1">&#39;</span> <span class="o">%</span>  <span class="n">time_pt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">))</span></div>

<div class="viewcode-block" id="SM.predict_derivatives"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.predict_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">predict_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">kx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict the dy_dx derivatives at a set of points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx] or np.ndarray[n]</span>
<span class="sd">            Input values for the prediction points.</span>
<span class="sd">        kx : int</span>
<span class="sd">            The 0-based index of the input variable with respect to which derivatives are desired.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dy_dx : np.ndarray[n, ny]</span>
<span class="sd">            Derivatives.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">check_2d_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">check_nx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_global&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;print_prediction&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MixExp&#39;</span><span class="p">:</span>
            <span class="c1"># Mixture of experts model</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_title</span><span class="p">(</span><span class="s1">&#39;Evaluation of the Mixture of experts&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_title</span><span class="p">(</span><span class="s1">&#39;Evaluation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">(</span><span class="s1">&#39;   </span><span class="si">%-12s</span><span class="s1"> : </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;# eval points.&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">()</span>

        <span class="c1">#Evaluate the unknown points using the specified model-method</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_timed_context</span><span class="p">(</span><span class="s1">&#39;Predicting&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;prediction&#39;</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_derivatives</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kx</span><span class="p">)</span>

        <span class="n">time_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">_time</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Prediction time/pt. (sec) : </span><span class="si">%10.7f</span><span class="s1">&#39;</span> <span class="o">%</span>  <span class="n">time_pt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">))</span></div>

<div class="viewcode-block" id="SM.predict_output_derivatives"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.predict_output_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">predict_output_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict the derivatives dy_dyt at a set of points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx] or np.ndarray[n]</span>
<span class="sd">            Input values for the prediction points.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dy_dyt : dict of np.ndarray[n, nt]</span>
<span class="sd">            Dictionary of output derivatives.</span>
<span class="sd">            Key is None for derivatives wrt yt and kx for derivatives wrt dyt_dxt.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;output_derivatives&#39;</span><span class="p">)</span>
        <span class="n">check_nx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">dy_dyt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_output_derivatives</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dy_dyt</span></div>

<div class="viewcode-block" id="SM.predict_variances"><a class="viewcode-back" href="../../../_src_docs/methods.html#smt.methods.sm.SM.predict_variances">[docs]</a>    <span class="k">def</span> <span class="nf">predict_variances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict the variances at a set of points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx] or np.ndarray[n]</span>
<span class="sd">            Input values for the prediction points.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        s2 : np.ndarray[n, ny]</span>
<span class="sd">            Variances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;variances&#39;</span><span class="p">)</span>
        <span class="n">check_nx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_variances</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s2</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">))</span></div>

<div class="viewcode-block" id="SM._initialize"><a class="viewcode-back" href="../../../_src_docs/dev_docs/dev_methods.html#smt.methods.sm.SM._initialize">[docs]</a>    <span class="k">def</span> <span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implemented by surrogate models to declare options and declare what they support (optional).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        self.options.declare(&#39;option_name&#39;, default_value, types=(bool, int), desc=&#39;description&#39;)</span>
<span class="sd">        self.supports[&#39;derivatives&#39;] = True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SM._train"><a class="viewcode-back" href="../../../_src_docs/dev_docs/dev_methods.html#smt.methods.sm.SM._train">[docs]</a>    <span class="k">def</span> <span class="nf">_train</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implemented by surrogate models to perform training (optional, but typically implemented).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SM._predict_values"><a class="viewcode-back" href="../../../_src_docs/dev_docs/dev_methods.html#smt.methods.sm.SM._predict_values">[docs]</a>    <span class="k">def</span> <span class="nf">_predict_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implemented by surrogate models to predict the output values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx]</span>
<span class="sd">            Input values for the prediction points.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        y : np.ndarray[n, ny]</span>
<span class="sd">            Output values at the prediction points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;This surrogate model is incorrectly implemented&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SM._predict_derivatives"><a class="viewcode-back" href="../../../_src_docs/dev_docs/dev_methods.html#smt.methods.sm.SM._predict_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">_predict_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">kx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implemented by surrogate models to predict the dy_dx derivatives (optional).</span>

<span class="sd">        If this method is implemented, the surrogate model should have</span>

<span class="sd">        ::</span>
<span class="sd">            self.supports[&#39;derivatives&#39;] = True</span>

<span class="sd">        in the _initialize() implementation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx]</span>
<span class="sd">            Input values for the prediction points.</span>
<span class="sd">        kx : int</span>
<span class="sd">            The 0-based index of the input variable with respect to which derivatives are desired.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dy_dx : np.ndarray[n, ny]</span>
<span class="sd">            Derivatives.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="n">fail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="SM._predict_output_derivatives"><a class="viewcode-back" href="../../../_src_docs/dev_docs/dev_methods.html#smt.methods.sm.SM._predict_output_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">_predict_output_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implemented by surrogate models to predict the dy_dyt derivatives (optional).</span>

<span class="sd">        If this method is implemented, the surrogate model should have</span>

<span class="sd">        ::</span>
<span class="sd">            self.supports[&#39;output_derivatives&#39;] = True</span>

<span class="sd">        in the _initialize() implementation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx]</span>
<span class="sd">            Input values for the prediction points.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dy_dyt : dict of np.ndarray[n, nt]</span>
<span class="sd">            Dictionary of output derivatives.</span>
<span class="sd">            Key is None for derivatives wrt yt and kx for derivatives wrt dyt_dxt.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;output_derivatives&#39;</span><span class="p">,</span> <span class="n">fail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="SM._predict_variances"><a class="viewcode-back" href="../../../_src_docs/dev_docs/dev_methods.html#smt.methods.sm.SM._predict_variances">[docs]</a>    <span class="k">def</span> <span class="nf">_predict_variances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implemented by surrogate models to predict the variances at a set of points (optional).</span>

<span class="sd">        If this method is implemented, the surrogate model should have</span>

<span class="sd">        ::</span>
<span class="sd">            self.supports[&#39;variances&#39;] = True</span>

<span class="sd">        in the _initialize() implementation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.ndarray[n, nx]</span>
<span class="sd">            Input values for the prediction points.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        s2 : np.ndarray[n, ny]</span>
<span class="sd">            Variances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;variances&#39;</span><span class="p">,</span> <span class="n">fail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SMT 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, John Hwang.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>